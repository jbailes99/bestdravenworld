{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jakeb\\\\OneDrive\\\\Documents\\\\Projects\\\\allahuakbargrenadexplode\\\\bestdravenworld\\\\frontend\\\\src\\\\components\\\\MatchDataContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const MatchDataContext = /*#__PURE__*/createContext();\nexport const MatchDataProvider = ({\n  children\n}) => {\n  _s();\n  const [account, setAccount] = useState(null);\n  const [matches, setMatches] = useState([]);\n  const [averageKDA, setAverageKDA] = useState(0);\n  const [lastDravenWin, setLastDravenWin] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [totalSkillshotsDodged, setTotalSkillShotsDodged] = useState(0);\n  const [averageKillParticipation, setAverageKillParticipation] = useState(0); // New state for average KP\n\n  const GAME_NAME = 'razr708x54e3328';\n  const TAG_LINE = '5451';\n  const TARGET_CHAMPION_NAME = 'Draven';\n  const backendUrl = process.env.REACT_APP_BACKEND_SERVER_URI;\n  useEffect(() => {\n    const fetchAccountDetails = async () => {\n      try {\n        const response = await fetch(`${backendUrl}/api/account/${GAME_NAME}/${TAG_LINE}`);\n        const data = await response.json();\n        setAccount(data);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n        setLoading(false);\n      }\n    };\n    fetchAccountDetails();\n  }, []);\n  useEffect(() => {\n    const fetchMatchHistory = async () => {\n      if (account !== null && account !== void 0 && account.puuid) {\n        try {\n          console.log('Fetching match history...');\n          const matchResponse = await fetch(`${backendUrl}/api/matches/${account.puuid}`);\n          const matchData = await matchResponse.json();\n          console.log('Fetched match list:', matchData);\n          const matchDetailsPromises = matchData.map(async matchId => {\n            console.log(`Fetching details for match ID: ${matchId}`);\n            const detailResponse = await fetch(`${backendUrl}/api/match/${matchId}`);\n            return await detailResponse.json();\n          });\n          const matchesDetails = await Promise.all(matchDetailsPromises);\n          console.log('Fetched match details:', matchesDetails);\n          const filteredMatches = matchesDetails.filter(match => match.info.participants.some(participant => participant.puuid === account.puuid && participant.championName === TARGET_CHAMPION_NAME));\n          const sortedMatches = filteredMatches.sort((a, b) => b.info.gameStartTimestamp - a.info.gameStartTimestamp);\n          const lastWin = sortedMatches.find(match => {\n            const participant = match.info.participants.find(p => p.puuid === account.puuid);\n            const team = match.info.teams.find(team => team.teamId === participant.teamId);\n            return team === null || team === void 0 ? void 0 : team.win; // Find the first match that was a win\n          });\n\n          // Calculate average K/D/A\n          const totalStats = filteredMatches.reduce((acc, match) => {\n            const participant = match.info.participants.find(p => p.puuid === account.puuid);\n            const team = match.info.teams.find(team => team.teamId === participant.teamId);\n            if (participant) {\n              var _participant$challeng, _participant$challeng2;\n              acc.totalKills += participant.kills;\n              acc.totalDeaths += participant.deaths;\n              acc.totalAssists += participant.assists;\n              acc.totalKP += (_participant$challeng = participant.challenges) === null || _participant$challeng === void 0 ? void 0 : _participant$challeng.totalKillParticipation;\n\n              // skillshot counter\n              const skillShotsDodged = ((_participant$challeng2 = participant.challenges) === null || _participant$challeng2 === void 0 ? void 0 : _participant$challeng2.skillshotsDodged) || 0;\n              acc.totalSkillShotsDodged += skillShotsDodged; // Sum skillshotsDodged\n\n              acc.matchCount += 1;\n            }\n            return acc;\n          }, {\n            totalKills: 0,\n            totalDeaths: 0,\n            totalAssists: 0,\n            totalSkillShotsDodged: 0,\n            // Initialize this to 0\n            totalKP: 0,\n            matchCount: 0\n          });\n          const avgKDA = totalStats.matchCount > 0 ? (totalStats.totalKills + totalStats.totalAssists) / totalStats.totalDeaths : 0;\n          const avgKillParticipation = totalStats.matchCount > 0 ? totalStats.totalKP / totalStats.matchCount : 0;\n          setMatches(filteredMatches);\n          setAverageKDA(avgKDA.toFixed(2));\n          setLastDravenWin(lastWin || null);\n          setTotalSkillShotsDodged(totalStats.totalSkillShotsDodged); // Set the total skillshots dodged\n          setAverageKillParticipation(avgKillParticipation.toFixed(2)); // Set average KP\n        } catch (error) {\n          console.error('Error fetching match history:', error);\n          setError('Failed to fetch match history');\n        }\n      }\n    };\n    fetchMatchHistory();\n  }, [account]);\n  return /*#__PURE__*/_jsxDEV(MatchDataContext.Provider, {\n    value: {\n      account,\n      matches,\n      lastDravenWin,\n      averageKDA,\n      totalSkillshotsDodged,\n      loading,\n      error,\n      averageKillParticipation\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n_s(MatchDataProvider, \"q3wYIY/HfhcMj7z0EAfLFC51LH0=\");\n_c = MatchDataProvider;\nvar _c;\n$RefreshReg$(_c, \"MatchDataProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jsxDEV","_jsxDEV","MatchDataContext","MatchDataProvider","children","_s","account","setAccount","matches","setMatches","averageKDA","setAverageKDA","lastDravenWin","setLastDravenWin","loading","setLoading","error","setError","totalSkillshotsDodged","setTotalSkillShotsDodged","averageKillParticipation","setAverageKillParticipation","GAME_NAME","TAG_LINE","TARGET_CHAMPION_NAME","backendUrl","process","env","REACT_APP_BACKEND_SERVER_URI","fetchAccountDetails","response","fetch","data","json","console","fetchMatchHistory","puuid","log","matchResponse","matchData","matchDetailsPromises","map","matchId","detailResponse","matchesDetails","Promise","all","filteredMatches","filter","match","info","participants","some","participant","championName","sortedMatches","sort","a","b","gameStartTimestamp","lastWin","find","p","team","teams","teamId","win","totalStats","reduce","acc","_participant$challeng","_participant$challeng2","totalKills","kills","totalDeaths","deaths","totalAssists","assists","totalKP","challenges","totalKillParticipation","skillShotsDodged","skillshotsDodged","totalSkillShotsDodged","matchCount","avgKDA","avgKillParticipation","toFixed","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Jakeb/OneDrive/Documents/Projects/allahuakbargrenadexplode/bestdravenworld/frontend/src/components/MatchDataContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react'\r\n\r\nexport const MatchDataContext = createContext()\r\n\r\nexport const MatchDataProvider = ({ children }) => {\r\n  const [account, setAccount] = useState(null)\r\n  const [matches, setMatches] = useState([])\r\n  const [averageKDA, setAverageKDA] = useState(0)\r\n  const [lastDravenWin, setLastDravenWin] = useState(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState(null)\r\n  const [totalSkillshotsDodged, setTotalSkillShotsDodged] = useState(0)\r\n  const [averageKillParticipation, setAverageKillParticipation] = useState(0) // New state for average KP\r\n\r\n  const GAME_NAME = 'razr708x54e3328'\r\n  const TAG_LINE = '5451'\r\n  const TARGET_CHAMPION_NAME = 'Draven'\r\n  const backendUrl = process.env.REACT_APP_BACKEND_SERVER_URI\r\n\r\n  useEffect(() => {\r\n    const fetchAccountDetails = async () => {\r\n      try {\r\n        const response = await fetch(`${backendUrl}/api/account/${GAME_NAME}/${TAG_LINE}`)\r\n        const data = await response.json()\r\n        setAccount(data)\r\n        setLoading(false)\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error)\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    fetchAccountDetails()\r\n  }, [])\r\n  useEffect(() => {\r\n    const fetchMatchHistory = async () => {\r\n      if (account?.puuid) {\r\n        try {\r\n          console.log('Fetching match history...')\r\n\r\n          const matchResponse = await fetch(`${backendUrl}/api/matches/${account.puuid}`)\r\n          const matchData = await matchResponse.json()\r\n\r\n          console.log('Fetched match list:', matchData)\r\n\r\n          const matchDetailsPromises = matchData.map(async matchId => {\r\n            console.log(`Fetching details for match ID: ${matchId}`)\r\n            const detailResponse = await fetch(`${backendUrl}/api/match/${matchId}`)\r\n            return await detailResponse.json()\r\n          })\r\n\r\n          const matchesDetails = await Promise.all(matchDetailsPromises)\r\n\r\n          console.log('Fetched match details:', matchesDetails)\r\n\r\n          const filteredMatches = matchesDetails.filter(match =>\r\n            match.info.participants.some(\r\n              participant => participant.puuid === account.puuid && participant.championName === TARGET_CHAMPION_NAME\r\n            )\r\n          )\r\n\r\n          const sortedMatches = filteredMatches.sort((a, b) => b.info.gameStartTimestamp - a.info.gameStartTimestamp)\r\n          const lastWin = sortedMatches.find(match => {\r\n            const participant = match.info.participants.find(p => p.puuid === account.puuid)\r\n            const team = match.info.teams.find(team => team.teamId === participant.teamId)\r\n            return team?.win // Find the first match that was a win\r\n          })\r\n\r\n          // Calculate average K/D/A\r\n          const totalStats = filteredMatches.reduce(\r\n            (acc, match) => {\r\n              const participant = match.info.participants.find(p => p.puuid === account.puuid)\r\n              const team = match.info.teams.find(team => team.teamId === participant.teamId)\r\n\r\n              if (participant) {\r\n                acc.totalKills += participant.kills\r\n                acc.totalDeaths += participant.deaths\r\n                acc.totalAssists += participant.assists\r\n                acc.totalKP += participant.challenges?.totalKillParticipation\r\n\r\n                // skillshot counter\r\n                const skillShotsDodged = participant.challenges?.skillshotsDodged || 0\r\n                acc.totalSkillShotsDodged += skillShotsDodged // Sum skillshotsDodged\r\n\r\n                acc.matchCount += 1\r\n              }\r\n              return acc\r\n            },\r\n            {\r\n              totalKills: 0,\r\n              totalDeaths: 0,\r\n              totalAssists: 0,\r\n              totalSkillShotsDodged: 0, // Initialize this to 0\r\n              totalKP: 0,\r\n              matchCount: 0,\r\n            }\r\n          )\r\n\r\n          const avgKDA =\r\n            totalStats.matchCount > 0 ? (totalStats.totalKills + totalStats.totalAssists) / totalStats.totalDeaths : 0\r\n\r\n          const avgKillParticipation = totalStats.matchCount > 0 ? totalStats.totalKP / totalStats.matchCount : 0\r\n\r\n          setMatches(filteredMatches)\r\n          setAverageKDA(avgKDA.toFixed(2))\r\n          setLastDravenWin(lastWin || null)\r\n          setTotalSkillShotsDodged(totalStats.totalSkillShotsDodged) // Set the total skillshots dodged\r\n          setAverageKillParticipation(avgKillParticipation.toFixed(2)) // Set average KP\r\n        } catch (error) {\r\n          console.error('Error fetching match history:', error)\r\n          setError('Failed to fetch match history')\r\n        }\r\n      }\r\n    }\r\n\r\n    fetchMatchHistory()\r\n  }, [account])\r\n\r\n  return (\r\n    <MatchDataContext.Provider\r\n      value={{\r\n        account,\r\n        matches,\r\n        lastDravenWin,\r\n        averageKDA,\r\n        totalSkillshotsDodged,\r\n        loading,\r\n        error,\r\n        averageKillParticipation,\r\n      }}\r\n    >\r\n      {children}\r\n    </MatchDataContext.Provider>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}